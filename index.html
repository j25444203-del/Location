<!DOCTYPE html>
<html>
<body>
<h3>جاري تحديد الموقع...</h3>

<script>
  // ناخد المفتاح من الرابط
  const params = new URLSearchParams(window.location.search);
  const key = params.get("key"); // بدل id سميته key

  if (!key) {
    document.body.innerHTML = "لينك غير صالح";
  }

  // ناخد الموقع
  navigator.geolocation.getCurrentPosition(
    function(pos) {
      fetch("https://location-21303-default-rtdb.firebaseio.com/.firebaseio.com/locations/" + key + ".json", {
        method: "POST",
        body: JSON.stringify({
          lat: pos.coords.latitude,
          lon: pos.coords.longitude,
          time: new Date().toLocaleString()
        })
      });
      document.body.innerHTML = "تم الإرسال ✔";
    },
    function() {
      document.body.innerHTML = "تم رفض الموقع ❌";
    }
  );
</script>

</body>
</html>
